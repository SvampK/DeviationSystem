Mgmt_My_Department As screen:
    LoadingSpinnerColor: =RGBA(105, 121, 126, 1)
    OnVisible: |-
        =If(varCollectDataCheck = false,
        UpdateContext({varPreLoader: true});
        ClearCollect(
            colTableData,
            Filter(
                colSystem,
                Phase.Value = "Ongoing"
            )
        );
        Set(varCollectDataCheck, true)
        );/*
        If(
            IsBlank(First('Office365-användare'.DirectReportsV2(varUserPrincipalName).value).department),
            Set(
                varParentDepartment,
                Concat(
                    Filter(
                        colData,
                        'Parent' = First(
                            Filter(
                                colData,
                                Location = First(colUser).Department
                            )
                        ).'Parent'
                    ),
                    Location,
                    ";"
                )
            ),
            Set(
                varParentDepartment,
                Concat(
                    Filter(
                        colData,
                        'Parent' = First(
                            Filter(
                                colData,
                                Location = First('Office365-användare'.DirectReportsV2(varUserPrincipalName).value).department
                            )
                        ).'Parent'
                    ),
                    Location,
                    ";"
                )
            )
        );*/
        If(
            IsBlank(varUserDirectReport.department),
            Set(
            varParentDepartment,
            ForAll(
                Filter(
                    colData,
                    'Parent' = LookUp(
                        colData,
                        Location = First(colUser).Department And (City = First(colUser).City Or IsBlank(City))
                    ).'Parent'
                ),
                {Location: Location, ID: ID}
            )
        ),
        Set(
            varParentDepartment,
            ForAll(
                Filter(
                    colData,
                    'Parent' = LookUp(
                        colData,
                        Location = varUserDirectReport.department And City = varUserDirectReport.city
                    ).'Parent'
                ),
                {Location: Location, ID: ID}
            )
        ));
        UpdateContext({locSortDirection: false});
        UpdateContext({locSortColumn: "Created"});
        UpdateContext(
            {
                locFilterIsSelected: {
                    column: "",
                    selected: false
                }
            }
        );
        Concurrent(
            If(
                !Checkbox1.Value,
                UpdateContext({locFilterAssignee: ""});
                varIsResponsible, 
                UpdateContext({locFilterAssignee: First(colUser).DisplayName});
            ),
            If(
                !Checkbox1_2.Value,
                UpdateContext({locFilterManager: ""}),
                UpdateContext({locFilterManager: First(colUser).DisplayName});
            ),
            If(
                !Checkbox1_2.Value,
                UpdateContext({locFilterMyDepartment: []}),
                UpdateContext({locFilterMyDepartment: ForAll(varParentDepartment, ID)})
            ),
            If(
                !Checkbox1_3,
                UpdateContext({locFilterCompany: ""})
            )
        );
        Select(collectMyDepartment);

    Icon6 As icon.ChevronDown:
        BorderColor: =RGBA(166, 166, 166, 1)
        Color: =RGBA(255, 255, 255, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(220, 220, 220, 1)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Height: =40
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
        HoverFill: =RGBA(0, 0, 0, 0)
        Icon: =Icon.ChevronDown
        OnSelect: |-
            =Switch(locRotate180,0,UpdateContext({locRotate180: 180}),Blank(),UpdateContext({locRotate180: 180}),180,UpdateContext({locRotate180: 0}))
        PaddingBottom: =10
        PaddingLeft: =10
        PaddingRight: =10
        PaddingTop: =10
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
        PressedFill: =RGBA(0, 0, 0, 0)
        Rotation: =locRotate180
        Width: =40
        X: =210
        Y: =170
        ZIndex: =1

    Icon6_1 As icon.ChevronDown:
        BorderColor: =RGBA(166, 166, 166, 1)
        Color: =RGBA(255, 255, 255, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(220, 220, 220, 1)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Height: =40
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
        HoverFill: =RGBA(0, 0, 0, 0)
        Icon: =Icon.ChevronDown
        OnSelect: |-
            =Switch(locRotate180,0,UpdateContext({locRotate180: 180}),Blank(),UpdateContext({locRotate180: 180}),180,UpdateContext({locRotate180: 0}))
        PaddingBottom: =10
        PaddingLeft: =10
        PaddingRight: =10
        PaddingTop: =10
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
        PressedFill: =RGBA(0, 0, 0, 0)
        Rotation: =locRotate180
        Width: =40
        X: =360
        Y: =170
        ZIndex: =2

    Container4 As groupContainer.horizontalAutoLayoutContainer:
        Height: =Parent.Height - Self.Y - 20
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowX: =LayoutOverflow.Scroll
        Width: =Parent.Width * 0.95
        X: =Parent.Width / 2 - Self.Width / 2
        Y: =If(dropdownFilters.Visible, dropdownFilters.Y + dropdownFilters.Height + 10, checkboxesContainer.Y + checkboxesContainer.Height + 10)
        ZIndex: =3

        Container5 As groupContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =Parent.Height
            LayoutMinHeight: =100
            LayoutMinWidth: =3200
            Width: =If(varClosedView = 1, hdrTitle.Width * 20 + 5, (hdrTitle.Width * 17) + 5)//3200
            ZIndex: =1

            MgmtTable As gallery.galleryVertical:
                BorderColor: =RGBA(166, 166, 166, 1)
                DelayItemLoading: =true
                Fill: =White
                FocusedBorderThickness: =0
                Height: =Parent.Height - Self.Y - 20 //Self.TemplateHeight * CountRows(MgmtTable.AllItems)
                Items: |-
                    =SortByColumns(
                        colMyDepartment,
                        If(
                            locSortColumn = "Type",
                            "Title",
                            locSortColumn
                        ),
                        If(
                            locSortDirection,
                            Ascending,
                            Descending
                        )
                    )
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                OnSelect: |-
                    =Set(
                        varDataTableEdit,
                        LookUp(colSystem, ID = MgmtTable.Selected.ID)
                    );
                    Set(
                        varSupplierSent,
                        false
                    );
                    Set(varFromDraft, false);
                    Set(varFollowUp, false);
                    //View only if not assignee
                    //If(ThisItem.Responsible.DisplayName = First(colUser).DisplayName, Set(varFormMode, "Edit"), Set(varFormMode, "View"));
                    EditForm(Form1);
                    Navigate(Form, None, {varPreLoader: true});
                ShowNavigation: =true
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =40
                Visible: |-
                    =!varPreLoader And First(MgmtTable.AllItems).ID = First(
                        SortByColumns(
                            colMyDepartment,
                            If(
                                locSortColumn = "Type",
                                "Title",
                                locSortColumn
                            ),
                            If(
                                locSortDirection,
                                Ascending,
                                Descending
                            )
                        )
                    ).ID
                Width: =hdrTitle.Width * 19//Parent.Width
                Y: =40
                ZIndex: =1

                cntGalleryItem As groupContainer.horizontalAutoLayoutContainer:
                    Height: =40
                    LayoutMode: =LayoutMode.Auto
                    Width: =Parent.Width
                    ZIndex: =20

                    tlbType As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        Fill: |-
                            =If(First(
                                    Split(
                                        tblTitle.Text,
                                        "_"
                                    )
                                ).Result = "IM", ColorValue("#BBE6FA"), ColorValue("#FFF0CF"))
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        Size: =9.25
                        Text: |-
                            =Switch(
                                First(
                                    Split(
                                        tblTitle.Text,
                                        "_"
                                    )
                                ).Result,
                                "IM",
                                LookUp(
                                        colTranslations,
                                        key = "button_newimprovement" && language.Value = varLanguage
                                    
                                ).Title,
                                "DV",
                                LookUp(
                                        colTranslations,
                                        key = "button_newdeviation" && language.Value = varLanguage
                                    
                                ).Title
                            )
                        Width: =100
                        ZIndex: =1

                    tblTitle As button:
                        BorderColor: =RGBA(202, 202, 202, 1)
                        BorderThickness: =1
                        Color: =RGBA(0, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        DisabledFill: =RGBA(244, 244, 244, 1)
                        Fill: =RGBA(244, 244, 244, 1)
                        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        HoverBorderColor: =RGBA(0, 0, 0, 0)
                        HoverColor: =RGBA(255, 255, 255, 1)
                        HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
                        OnSelect: =Select(MgmtTable)
                        PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
                        PressedColor: =RGBA(255, 255, 255, 1)
                        PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =8
                        Text: =ThisItem.Title
                        Width: =190
                        ZIndex: =2

                    tblFinishedDate As label:
                        BorderColor: =RGBA(219, 219, 219, 1)
                        BorderThickness: =1
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        Size: =9.25
                        Text: =ThisItem.FinishedDate
                        Visible: =varClosedView
                        Width: =190
                        X: =tblModifiedBy.X + tblModifiedBy.Width
                        ZIndex: =3

                    tblModifiedBy As label:
                        BorderColor: =RGBA(219, 219, 219, 1)
                        BorderThickness: =1
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        Size: =9.25
                        Text: =ThisItem.ModifiedBy
                        Visible: =varClosedView
                        Width: =190
                        X: =tblSerious.X + tblSerious.Width
                        ZIndex: =4

                    tblActionsTaken As label:
                        BorderColor: =RGBA(219, 219, 219, 1)
                        BorderThickness: =1
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        Size: =9.25
                        Text: =PlainText(ThisItem.'Actions Taken')
                        Visible: =varClosedView
                        Width: =190
                        X: =tblFinishedDate.X + tblFinishedDate.Width
                        ZIndex: =5

                    tblCreated As label:
                        BorderColor: =RGBA(219, 219, 219, 1)
                        BorderThickness: =1
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        Size: =9.25
                        Text: =ThisItem.Created
                        Width: =190
                        X: =190
                        ZIndex: =6

                    tblAssigneeStarted As label:
                        BorderColor: =RGBA(219, 219, 219, 1)
                        BorderThickness: =1
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        Size: =9.25
                        Text: |-
                            =Last(
                                FirstN(
                                    Split(
                                        LookUp(
                                            colAreaList,
                                            'Area/Specific Area' = "Boolean" And Lower(Title) = Text(ThisItem.AssigneeStarted)
                                        ).Translation,
                                        ";"
                                    ),
                                    varLanguageID
                                )
                            ).Result
                        Visible: =!varClosedView
                        Width: =180
                        X: =tblActionsTaken.X + tblActionsTaken.Width
                        ZIndex: =7

                    tblAuthor As label:
                        BorderColor: =RGBA(219, 219, 219, 1)
                        BorderThickness: =1
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        Size: =9.25
                        Text: =ThisItem.AuthorName
                        Width: =190
                        X: =tblActionsTaken.X + tblActionsTaken.Width
                        ZIndex: =8

                    tblDescription As label:
                        AlignInContainer: =AlignInContainer.Stretch
                        BorderColor: =RGBA(219, 219, 219, 1)
                        BorderThickness: =1
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        Overflow: =Overflow.Scroll
                        Size: =9.25
                        Text: =PlainText(ThisItem.Description)
                        Width: =190
                        X: =tblMyDepartment.X + tblMyDepartment.Width
                        ZIndex: =9

                    tblArea As label:
                        BorderColor: =RGBA(219, 219, 219, 1)
                        BorderThickness: =1
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        Size: =9.25
                        Text: |-
                            =Last(
                                FirstN(
                                    Split(
                                        LookUp(
                                                colAreaList,
                                                ('Area/Specific Area' = "Area" Or 'Area/Specific Area' = "OldArea") And Title = ThisItem.Area.Value
                                            
                                        ).Translation,
                                        ";"
                                    ),
                                    varLanguageID
                                )
                            ).Result
                        Width: =190
                        X: =490
                        ZIndex: =10

                    tblAssignee As label:
                        BorderColor: =RGBA(219, 219, 219, 1)
                        BorderThickness: =1
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        Size: =9.25
                        Text: =ThisItem.Responsible.DisplayName
                        Width: =190
                        X: =340
                        ZIndex: =11

                    tblSpecArea As label:
                        BorderColor: =RGBA(219, 219, 219, 1)
                        BorderThickness: =1
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        Size: =9.25
                        Text: |-
                            =Last(
                                FirstN(
                                    Split(
                                        LookUp(
                                            colAreaList,
                                            'Area/Specific Area' = "Specific Area" And Title = ThisItem.'Specific Area'.Value
                                        ).Translation,
                                        ";"
                                    ),
                                    varLanguageID
                                )
                            ).Result
                        Width: =190
                        X: =640
                        ZIndex: =12

                    tblSerious As label:
                        BorderColor: =RGBA(219, 219, 219, 1)
                        BorderThickness: =1
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        Size: =9.25
                        Text: |-
                            =Last(
                                FirstN(
                                    Split(
                                        LookUp(
                                            colAreaList,
                                            'Area/Specific Area' = "Boolean" And Lower(Title) = Text(ThisItem.Serious)
                                        ).Translation,
                                        ";"
                                    ),
                                    varLanguageID
                                )
                            ).Result
                        Width: =190
                        X: =tblObsDate.X + tblObsDate.Width
                        ZIndex: =13

                    tblObsDate As label:
                        BorderColor: =RGBA(219, 219, 219, 1)
                        BorderThickness: =1
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        Size: =9.25
                        Text: =ThisItem.IncidentDate
                        Width: =190
                        X: =tblDescription.X + tblDescription.Width
                        ZIndex: =14

                    tblMyDepartment As label:
                        BorderColor: =RGBA(219, 219, 219, 1)
                        BorderThickness: =1
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        Size: =9.25
                        Text: =ThisItem.MyDepartment.Value
                        Width: =190
                        X: =tblOwner.X + tblOwner.Width
                        ZIndex: =15

                    tblOwner As label:
                        BorderColor: =RGBA(219, 219, 219, 1)
                        BorderThickness: =1
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        Size: =9.25
                        Text: =ThisItem.Owner.DisplayName
                        Width: =190
                        X: =1090
                        ZIndex: =16

                    tblOpMan As label:
                        BorderColor: =RGBA(219, 219, 219, 1)
                        BorderThickness: =1
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        Size: =9.25
                        Text: =ThisItem.'Operations Manager'.DisplayName
                        Width: =190
                        X: =940
                        ZIndex: =17

                    tblOtherClinic As label:
                        BorderColor: =RGBA(219, 219, 219, 1)
                        BorderThickness: =1
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        Size: =9.25
                        Text: =ThisItem.Location.Value
                        Width: =190
                        X: =790
                        ZIndex: =18

                    tblSupplier As label:
                        BorderColor: =RGBA(219, 219, 219, 1)
                        BorderThickness: =1
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        Size: =9.25
                        Text: =ThisItem.SupplierValue
                        Width: =190
                        X: =tblActionsTaken.X + tblActionsTaken.Width
                        ZIndex: =19

                    tblSupplier_3 As label:
                        BorderColor: =RGBA(219, 219, 219, 1)
                        BorderThickness: =1
                        Color: =RGBA(51, 51, 51, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        DisabledColor: =RGBA(166, 166, 166, 1)
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        Size: =9.25
                        Text: =ThisItem.SupportFunctionValue
                        Width: =190
                        X: =tblActionsTaken.X + tblActionsTaken.Width
                        ZIndex: =20

            cntHeaders As groupContainer.horizontalAutoLayoutContainer:
                Height: =40
                LayoutMode: =LayoutMode.Auto
                Width: =Parent.Width
                ZIndex: =2

                hdrType As TableHeader:
                    ButtonIsSelected: =Self.ButtonSortValue = locSortColumn
                    ButtonOnSelect: |-
                        =UpdateContext({locSortColumn: Self.ButtonSortValue});UpdateContext({locSortDirection: !locSortDirection})
                    ButtonSortValue: ="Type"
                    ButtonText: =First(Filter(colTranslations, key = "label_type" && language.Value = varLanguage)).Title
                    FilterIsSelected: =If(Self.ButtonSortValue = locFilterIsSelected.column, locFilterIsSelected.selected, false)
                    FilterOnSelect: |-
                        =UpdateContext(
                            {
                                locFilterIsSelected: {
                                    column: Self.ButtonSortValue,
                                    selected: !locFilterIsSelected.selected
                                }
                            }
                        );
                        ClearCollect(
                            colTableFilter,
                            AddColumns(
                                colTableData,
                                "helper",
                                Switch(
                                    locFilterIsSelected.column,
                                    "Type",
                                    Switch(
                                        First(
                                            Split(
                                                Title,
                                                "_"
                                            )
                                        ).Result,
                                        "IM",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newimprovement" && language.Value = varLanguage
                                            )
                                        ).Title,
                                        "DV",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newdeviation" && language.Value = varLanguage
                                            )
                                        ).Title
                                    ),
                                    "Title",
                                    Title,
                                    "Created",
                                    Created,
                                    "AssigneeName",
                                    Responsible.DisplayName,
                                    "AreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        ('Area/Specific Area' = "Area" Or 'Area/Specific Area' = "OldArea") And Title = Area.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "SpecificAreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Specific Area" And Title = 'Specific Area'.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "OtherClinicValue",
                                    Location.Value,
                                    "OperationsManagerName",
                                    'Operations Manager'.DisplayName,
                                    "OwnerName",
                                    Owner.DisplayName,
                                    "MyDepartmentValue",
                                    MyDepartment.Value,
                                    "Description",
                                    PlainText(Description),
                                    "IncidentDate",
                                    IncidentDate,
                                    "Severe",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Boolean" And Lower(Title) = Text(Serious)
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "ModifiedBy",
                                    'Modified By'.DisplayName,
                                    "FinishedDate",
                                    FinishedDate,
                                    "ActionsTaken",
                                    PlainText('Actions Taken'),
                                    "Supplier",
                                    Supplier.Value,
                                    "SupportFunctionValue",
                                    SupportFunction.Value,
                                    "AuthorName",
                                    'Created By'.DisplayName,
                                    "AssigneeStarted",
                                    Last(
                                        FirstN(
                                            Split(
                                                LookUp(
                                                    colAreaList,
                                                    'Area/Specific Area' = "Boolean" And Lower(Title) = Text(AssigneeStarted)
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result
                                )
                            )
                        )
                    LayoutMinHeight: =640
                    LayoutMinWidth: =640
                    SortRotate: =If(Self.ButtonSortValue = locSortColumn && locSortDirection, 180, Self.ButtonSortValue = locSortColumn && locSortDirection = false, 0)
                    Width: =100

                hdrTitle As TableHeader:
                    ButtonIsSelected: =Self.ButtonSortValue = locSortColumn
                    ButtonOnSelect: |-
                        =UpdateContext({locSortColumn: Self.ButtonSortValue});UpdateContext({locSortDirection: !locSortDirection})
                    ButtonSortValue: ="Title"
                    ButtonText: =LookUp(colTranslations, language.Value = varLanguage And key = "table_column_title").Title
                    FilterIsSelected: =If(Self.ButtonSortValue = locFilterIsSelected.column, locFilterIsSelected.selected, false)
                    FilterOnSelect: |-
                        =UpdateContext(
                            {
                                locFilterIsSelected: {
                                    column: Self.ButtonSortValue,
                                    selected: !locFilterIsSelected.selected
                                }
                            }
                        );
                        ClearCollect(
                            colTableFilter,
                            AddColumns(
                                colTableData,
                                "helper",
                                Switch(
                                    locFilterIsSelected.column,
                                    "Type",
                                    Switch(
                                        First(
                                            Split(
                                                Title,
                                                "_"
                                            )
                                        ).Result,
                                        "IM",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newimprovement" && language.Value = varLanguage
                                            )
                                        ).Title,
                                        "DV",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newdeviation" && language.Value = varLanguage
                                            )
                                        ).Title
                                    ),
                                    "Title",
                                    Title,
                                    "Created",
                                    Created,
                                    "AssigneeName",
                                    Responsible.DisplayName,
                                    "AreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        ('Area/Specific Area' = "Area" Or 'Area/Specific Area' = "OldArea") And Title = Area.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "SpecificAreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Specific Area" And Title = 'Specific Area'.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "OtherClinicValue",
                                    Location.Value,
                                    "OperationsManagerName",
                                    'Operations Manager'.DisplayName,
                                    "OwnerName",
                                    Owner.DisplayName,
                                    "MyDepartmentValue",
                                    MyDepartment.Value,
                                    "Description",
                                    PlainText(Description),
                                    "IncidentDate",
                                    IncidentDate,
                                    "Severe",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Boolean" And Lower(Title) = Text(Serious)
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "ModifiedBy",
                                    'Modified By'.DisplayName,
                                    "FinishedDate",
                                    FinishedDate,
                                    "ActionsTaken",
                                    PlainText('Actions Taken'),
                                    "Supplier",
                                    Supplier.Value,
                                    "SupportFunctionValue",
                                    SupportFunction.Value,
                                    "AuthorName",
                                    'Created By'.DisplayName,
                                    "AssigneeStarted",
                                    Last(
                                        FirstN(
                                            Split(
                                                LookUp(
                                                    colAreaList,
                                                    'Area/Specific Area' = "Boolean" And Lower(Title) = Text(AssigneeStarted)
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result
                                )
                            )
                        )
                    LayoutMinHeight: =640
                    LayoutMinWidth: =640
                    SortRotate: =If(Self.ButtonSortValue = locSortColumn && locSortDirection, 180, Self.ButtonSortValue = locSortColumn && locSortDirection = false, 0)
                    Width: =190
                    ZIndex: =2

                hdrFinishedDate As TableHeader:
                    ButtonIsSelected: =Self.ButtonSortValue = locSortColumn
                    ButtonOnSelect: |-
                        =UpdateContext({locSortColumn: Self.ButtonSortValue});UpdateContext({locSortDirection: !locSortDirection})
                    ButtonSortValue: ="FinishedDate"
                    ButtonText: ="Finished Date"
                    FilterIsSelected: =If(Self.ButtonSortValue = locFilterIsSelected.column, locFilterIsSelected.selected, false)
                    FilterOnSelect: |-
                        =UpdateContext(
                            {
                                locFilterIsSelected: {
                                    column: Self.ButtonSortValue,
                                    selected: !locFilterIsSelected.selected
                                }
                            }
                        );
                        ClearCollect(
                            colTableFilter,
                            AddColumns(
                                colTableData,
                                "helper",
                                Switch(
                                    locFilterIsSelected.column,
                                    "Type",
                                    Switch(
                                        First(
                                            Split(
                                                Title,
                                                "_"
                                            )
                                        ).Result,
                                        "IM",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newimprovement" && language.Value = varLanguage
                                            )
                                        ).Title,
                                        "DV",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newdeviation" && language.Value = varLanguage
                                            )
                                        ).Title
                                    ),
                                    "Title",
                                    Title,
                                    "Created",
                                    Created,
                                    "AssigneeName",
                                    Responsible.DisplayName,
                                    "AreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        ('Area/Specific Area' = "Area" Or 'Area/Specific Area' = "OldArea") And Title = Area.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "SpecificAreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Specific Area" And Title = 'Specific Area'.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "OtherClinicValue",
                                    Location.Value,
                                    "OperationsManagerName",
                                    'Operations Manager'.DisplayName,
                                    "OwnerName",
                                    Owner.DisplayName,
                                    "MyDepartmentValue",
                                    MyDepartment.Value,
                                    "Description",
                                    PlainText(Description),
                                    "IncidentDate",
                                    IncidentDate,
                                    "Severe",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Boolean" And Lower(Title) = Text(Serious)
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "ModifiedBy",
                                    'Modified By'.DisplayName,
                                    "FinishedDate",
                                    FinishedDate,
                                    "ActionsTaken",
                                    PlainText('Actions Taken'),
                                    "Supplier",
                                    Supplier.Value,
                                    "SupportFunctionValue",
                                    SupportFunction.Value,
                                    "AuthorName",
                                    'Created By'.DisplayName,
                                    "AssigneeStarted",
                                    Last(
                                        FirstN(
                                            Split(
                                                LookUp(
                                                    colAreaList,
                                                    'Area/Specific Area' = "Boolean" And Lower(Title) = Text(AssigneeStarted)
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result
                                )
                            )
                        )
                    LayoutMinHeight: =640
                    LayoutMinWidth: =640
                    SortRotate: =If(Self.ButtonSortValue = locSortColumn && locSortDirection, 180, Self.ButtonSortValue = locSortColumn && locSortDirection = false, 0)
                    Visible: =varClosedView
                    Width: =190
                    X: =hdrModifiedBy.X + hdrModifiedBy.Width
                    ZIndex: =3

                hdrModifiedBy As TableHeader:
                    ButtonIsSelected: =Self.ButtonSortValue = locSortColumn
                    ButtonOnSelect: |-
                        =UpdateContext({locSortColumn: Self.ButtonSortValue});UpdateContext({locSortDirection: !locSortDirection})
                    ButtonSortValue: ="ModifiedBy"
                    ButtonText: ="Modified By"
                    FilterIsSelected: =If(Self.ButtonSortValue = locFilterIsSelected.column, locFilterIsSelected.selected, false)
                    FilterOnSelect: |-
                        =UpdateContext(
                            {
                                locFilterIsSelected: {
                                    column: Self.ButtonSortValue,
                                    selected: !locFilterIsSelected.selected
                                }
                            }
                        );
                        ClearCollect(
                            colTableFilter,
                            AddColumns(
                                colTableData,
                                "helper",
                                Switch(
                                    locFilterIsSelected.column,
                                    "Type",
                                    Switch(
                                        First(
                                            Split(
                                                Title,
                                                "_"
                                            )
                                        ).Result,
                                        "IM",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newimprovement" && language.Value = varLanguage
                                            )
                                        ).Title,
                                        "DV",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newdeviation" && language.Value = varLanguage
                                            )
                                        ).Title
                                    ),
                                    "Title",
                                    Title,
                                    "Created",
                                    Created,
                                    "AssigneeName",
                                    Responsible.DisplayName,
                                    "AreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        ('Area/Specific Area' = "Area" Or 'Area/Specific Area' = "OldArea") And Title = Area.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "SpecificAreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Specific Area" And Title = 'Specific Area'.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "OtherClinicValue",
                                    Location.Value,
                                    "OperationsManagerName",
                                    'Operations Manager'.DisplayName,
                                    "OwnerName",
                                    Owner.DisplayName,
                                    "MyDepartmentValue",
                                    MyDepartment.Value,
                                    "Description",
                                    PlainText(Description),
                                    "IncidentDate",
                                    IncidentDate,
                                    "Severe",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Boolean" And Lower(Title) = Text(Serious)
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "ModifiedBy",
                                    'Modified By'.DisplayName,
                                    "FinishedDate",
                                    FinishedDate,
                                    "ActionsTaken",
                                    PlainText('Actions Taken'),
                                    "Supplier",
                                    Supplier.Value,
                                    "SupportFunctionValue",
                                    SupportFunction.Value,
                                    "AuthorName",
                                    'Created By'.DisplayName,
                                    "AssigneeStarted",
                                    Last(
                                        FirstN(
                                            Split(
                                                LookUp(
                                                    colAreaList,
                                                    'Area/Specific Area' = "Boolean" And Lower(Title) = Text(AssigneeStarted)
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result
                                )
                            )
                        )
                    LayoutMinHeight: =640
                    LayoutMinWidth: =640
                    SortRotate: =If(Self.ButtonSortValue = locSortColumn && locSortDirection, 180, Self.ButtonSortValue = locSortColumn && locSortDirection = false, 0)
                    Visible: =varClosedView
                    Width: =190
                    X: =hdrSerious.X + hdrSerious.Width
                    ZIndex: =4

                hdrActionsTaken As TableHeader:
                    ButtonIsSelected: =Self.ButtonSortValue = locSortColumn
                    ButtonOnSelect: |-
                        =UpdateContext({locSortColumn: Self.ButtonSortValue});UpdateContext({locSortDirection: !locSortDirection})
                    ButtonSortValue: ="ActionsTaken"
                    ButtonText: ="Actions Taken"
                    FilterIsSelected: =If(Self.ButtonSortValue = locFilterIsSelected.column, locFilterIsSelected.selected, false)
                    FilterOnSelect: |-
                        =UpdateContext(
                            {
                                locFilterIsSelected: {
                                    column: Self.ButtonSortValue,
                                    selected: !locFilterIsSelected.selected
                                }
                            }
                        );
                        ClearCollect(
                            colTableFilter,
                            AddColumns(
                                colTableData,
                                "helper",
                                Switch(
                                    locFilterIsSelected.column,
                                    "Type",
                                    Switch(
                                        First(
                                            Split(
                                                Title,
                                                "_"
                                            )
                                        ).Result,
                                        "IM",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newimprovement" && language.Value = varLanguage
                                            )
                                        ).Title,
                                        "DV",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newdeviation" && language.Value = varLanguage
                                            )
                                        ).Title
                                    ),
                                    "Title",
                                    Title,
                                    "Created",
                                    Created,
                                    "AssigneeName",
                                    Responsible.DisplayName,
                                    "AreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        ('Area/Specific Area' = "Area" Or 'Area/Specific Area' = "OldArea") And Title = Area.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "SpecificAreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Specific Area" And Title = 'Specific Area'.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "OtherClinicValue",
                                    Location.Value,
                                    "OperationsManagerName",
                                    'Operations Manager'.DisplayName,
                                    "OwnerName",
                                    Owner.DisplayName,
                                    "MyDepartmentValue",
                                    MyDepartment.Value,
                                    "Description",
                                    PlainText(Description),
                                    "IncidentDate",
                                    IncidentDate,
                                    "Severe",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Boolean" And Lower(Title) = Text(Serious)
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "ModifiedBy",
                                    'Modified By'.DisplayName,
                                    "FinishedDate",
                                    FinishedDate,
                                    "ActionsTaken",
                                    PlainText('Actions Taken'),
                                    "Supplier",
                                    Supplier.Value,
                                    "SupportFunctionValue",
                                    SupportFunction.Value,
                                    "AuthorName",
                                    'Created By'.DisplayName,
                                    "AssigneeStarted",
                                    Last(
                                        FirstN(
                                            Split(
                                                LookUp(
                                                    colAreaList,
                                                    'Area/Specific Area' = "Boolean" And Lower(Title) = Text(AssigneeStarted)
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result
                                )
                            )
                        )
                    LayoutMinHeight: =640
                    LayoutMinWidth: =640
                    SortRotate: =If(Self.ButtonSortValue = locSortColumn && locSortDirection, 180, Self.ButtonSortValue = locSortColumn && locSortDirection = false, 0)
                    Visible: =varClosedView
                    Width: =190
                    X: =hdrFinishedDate.X + hdrFinishedDate.Width
                    ZIndex: =5

                hdrCreated As TableHeader:
                    ButtonIsSelected: =Self.ButtonSortValue = locSortColumn
                    ButtonOnSelect: |-
                        =UpdateContext({locSortColumn: Self.ButtonSortValue});UpdateContext({locSortDirection: !locSortDirection})
                    ButtonSortValue: ="Created"
                    ButtonText: =LookUp(colTranslations, language.Value = varLanguage And key = "table_column_created").Title
                    FilterIsSelected: =If(Self.ButtonSortValue = locFilterIsSelected.column, locFilterIsSelected.selected, false)
                    FilterOnSelect: |-
                        =UpdateContext(
                            {
                                locFilterIsSelected: {
                                    column: Self.ButtonSortValue,
                                    selected: !locFilterIsSelected.selected
                                }
                            }
                        );
                        ClearCollect(
                            colTableFilter,
                            AddColumns(
                                colTableData,
                                "helper",
                                Switch(
                                    locFilterIsSelected.column,
                                    "Type",
                                    Switch(
                                        First(
                                            Split(
                                                Title,
                                                "_"
                                            )
                                        ).Result,
                                        "IM",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newimprovement" && language.Value = varLanguage
                                            )
                                        ).Title,
                                        "DV",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newdeviation" && language.Value = varLanguage
                                            )
                                        ).Title
                                    ),
                                    "Title",
                                    Title,
                                    "Created",
                                    Created,
                                    "AssigneeName",
                                    Responsible.DisplayName,
                                    "AreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        ('Area/Specific Area' = "Area" Or 'Area/Specific Area' = "OldArea") And Title = Area.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "SpecificAreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Specific Area" And Title = 'Specific Area'.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "OtherClinicValue",
                                    Location.Value,
                                    "OperationsManagerName",
                                    'Operations Manager'.DisplayName,
                                    "OwnerName",
                                    Owner.DisplayName,
                                    "MyDepartmentValue",
                                    MyDepartment.Value,
                                    "Description",
                                    PlainText(Description),
                                    "IncidentDate",
                                    IncidentDate,
                                    "Severe",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Boolean" And Lower(Title) = Text(Serious)
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "ModifiedBy",
                                    'Modified By'.DisplayName,
                                    "FinishedDate",
                                    FinishedDate,
                                    "ActionsTaken",
                                    PlainText('Actions Taken'),
                                    "Supplier",
                                    Supplier.Value,
                                    "SupportFunctionValue",
                                    SupportFunction.Value,
                                    "AuthorName",
                                    'Created By'.DisplayName,
                                    "AssigneeStarted",
                                    Last(
                                        FirstN(
                                            Split(
                                                LookUp(
                                                    colAreaList,
                                                    'Area/Specific Area' = "Boolean" And Lower(Title) = Text(AssigneeStarted)
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result
                                )
                            )
                        )
                    LayoutMinHeight: =640
                    LayoutMinWidth: =640
                    SortRotate: =If(Self.ButtonSortValue = locSortColumn && locSortDirection, 180, Self.ButtonSortValue = locSortColumn && locSortDirection = false, 0)
                    Width: =190
                    X: =190
                    ZIndex: =6

                hdrStarted As TableHeader:
                    ButtonIsSelected: =Self.ButtonSortValue = locSortColumn
                    ButtonOnSelect: |-
                        =UpdateContext({locSortColumn: Self.ButtonSortValue});UpdateContext({locSortDirection: !locSortDirection})
                    ButtonSortValue: ="AssigneeStarted"
                    ButtonText: =LookUp(colTranslations, language.Value = varLanguage And key = "form_label_started").Title
                    FilterIsSelected: =If(Self.ButtonSortValue = locFilterIsSelected.column, locFilterIsSelected.selected, false)
                    FilterOnSelect: |-
                        =UpdateContext(
                            {
                                locFilterIsSelected: {
                                    column: Self.ButtonSortValue,
                                    selected: !locFilterIsSelected.selected
                                }
                            }
                        );
                        ClearCollect(
                            colTableFilter,
                            AddColumns(
                                colTableData,
                                "helper",
                                Switch(
                                    locFilterIsSelected.column,
                                    "Type",
                                    Switch(
                                        First(
                                            Split(
                                                Title,
                                                "_"
                                            )
                                        ).Result,
                                        "IM",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newimprovement" && language.Value = varLanguage
                                            )
                                        ).Title,
                                        "DV",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newdeviation" && language.Value = varLanguage
                                            )
                                        ).Title
                                    ),
                                    "Title",
                                    Title,
                                    "Created",
                                    Created,
                                    "AssigneeName",
                                    Responsible.DisplayName,
                                    "AreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        ('Area/Specific Area' = "Area" Or 'Area/Specific Area' = "OldArea") And Title = Area.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "SpecificAreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Specific Area" And Title = 'Specific Area'.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "OtherClinicValue",
                                    Location.Value,
                                    "OperationsManagerName",
                                    'Operations Manager'.DisplayName,
                                    "OwnerName",
                                    Owner.DisplayName,
                                    "MyDepartmentValue",
                                    MyDepartment.Value,
                                    "Description",
                                    PlainText(Description),
                                    "IncidentDate",
                                    IncidentDate,
                                    "Severe",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Boolean" And Lower(Title) = Text(Serious)
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "ModifiedBy",
                                    'Modified By'.DisplayName,
                                    "FinishedDate",
                                    FinishedDate,
                                    "ActionsTaken",
                                    PlainText('Actions Taken'),
                                    "Supplier",
                                    Supplier.Value,
                                    "SupportFunctionValue",
                                    SupportFunction.Value,
                                    "AuthorName",
                                    'Created By'.DisplayName,
                                    "AssigneeStarted",
                                    Last(
                                        FirstN(
                                            Split(
                                                LookUp(
                                                    colAreaList,
                                                    'Area/Specific Area' = "Boolean" And Lower(Title) = Text(AssigneeStarted)
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result
                                )
                            )
                        )
                    LayoutMinHeight: =640
                    LayoutMinWidth: =640
                    SortRotate: =If(Self.ButtonSortValue = locSortColumn && locSortDirection, 180, Self.ButtonSortValue = locSortColumn && locSortDirection = false, 0)
                    Visible: =!varClosedView
                    Width: =180
                    ZIndex: =7

                hdrAuthor As TableHeader:
                    ButtonIsSelected: =Self.ButtonSortValue = locSortColumn
                    ButtonOnSelect: |-
                        =UpdateContext({locSortColumn: Self.ButtonSortValue});UpdateContext({locSortDirection: !locSortDirection})
                    ButtonSortValue: ="AuthorName"
                    ButtonText: =LookUp(colTranslations, language.Value = varLanguage And key = "table_column_author").Title
                    FilterIsSelected: =If(Self.ButtonSortValue = locFilterIsSelected.column, locFilterIsSelected.selected, false)
                    FilterOnSelect: |-
                        =UpdateContext(
                            {
                                locFilterIsSelected: {
                                    column: Self.ButtonSortValue,
                                    selected: !locFilterIsSelected.selected
                                }
                            }
                        );
                        ClearCollect(
                            colTableFilter,
                            AddColumns(
                                colTableData,
                                "helper",
                                Switch(
                                    locFilterIsSelected.column,
                                    "Type",
                                    Switch(
                                        First(
                                            Split(
                                                Title,
                                                "_"
                                            )
                                        ).Result,
                                        "IM",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newimprovement" && language.Value = varLanguage
                                            )
                                        ).Title,
                                        "DV",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newdeviation" && language.Value = varLanguage
                                            )
                                        ).Title
                                    ),
                                    "Title",
                                    Title,
                                    "Created",
                                    Created,
                                    "AssigneeName",
                                    Responsible.DisplayName,
                                    "AreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        ('Area/Specific Area' = "Area" Or 'Area/Specific Area' = "OldArea") And Title = Area.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "SpecificAreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Specific Area" And Title = 'Specific Area'.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "OtherClinicValue",
                                    Location.Value,
                                    "OperationsManagerName",
                                    'Operations Manager'.DisplayName,
                                    "OwnerName",
                                    Owner.DisplayName,
                                    "MyDepartmentValue",
                                    MyDepartment.Value,
                                    "Description",
                                    PlainText(Description),
                                    "IncidentDate",
                                    IncidentDate,
                                    "Severe",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Boolean" And Lower(Title) = Text(Serious)
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "ModifiedBy",
                                    'Modified By'.DisplayName,
                                    "FinishedDate",
                                    FinishedDate,
                                    "ActionsTaken",
                                    PlainText('Actions Taken'),
                                    "Supplier",
                                    Supplier.Value,
                                    "SupportFunctionValue",
                                    SupportFunction.Value,
                                    "AuthorName",
                                    'Created By'.DisplayName,
                                    "AssigneeStarted",
                                    Last(
                                        FirstN(
                                            Split(
                                                LookUp(
                                                    colAreaList,
                                                    'Area/Specific Area' = "Boolean" And Lower(Title) = Text(AssigneeStarted)
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result
                                )
                            )
                        )
                    LayoutMinHeight: =640
                    LayoutMinWidth: =640
                    SortRotate: =If(Self.ButtonSortValue = locSortColumn && locSortDirection, 180, Self.ButtonSortValue = locSortColumn && locSortDirection = false, 0)
                    Width: =190
                    X: =hdrActionsTaken.X + hdrActionsTaken.Width
                    ZIndex: =8

                hdrDescription As TableHeader:
                    ButtonIsSelected: =Self.ButtonSortValue = locSortColumn
                    ButtonOnSelect: |-
                        =UpdateContext({locSortColumn: Self.ButtonSortValue});UpdateContext({locSortDirection: !locSortDirection})
                    ButtonSortValue: ="Description"
                    ButtonText: =LookUp(colTranslations, language.Value = varLanguage And key = "form_label_description").Title
                    FilterIsSelected: =If(Self.ButtonSortValue = locFilterIsSelected.column, locFilterIsSelected.selected, false)
                    FilterOnSelect: |-
                        =UpdateContext(
                            {
                                locFilterIsSelected: {
                                    column: Self.ButtonSortValue,
                                    selected: !locFilterIsSelected.selected
                                }
                            }
                        );
                        ClearCollect(
                            colTableFilter,
                            AddColumns(
                                colTableData,
                                "helper",
                                Switch(
                                    locFilterIsSelected.column,
                                    "Type",
                                    Switch(
                                        First(
                                            Split(
                                                Title,
                                                "_"
                                            )
                                        ).Result,
                                        "IM",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newimprovement" && language.Value = varLanguage
                                            )
                                        ).Title,
                                        "DV",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newdeviation" && language.Value = varLanguage
                                            )
                                        ).Title
                                    ),
                                    "Title",
                                    Title,
                                    "Created",
                                    Created,
                                    "AssigneeName",
                                    Responsible.DisplayName,
                                    "AreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        ('Area/Specific Area' = "Area" Or 'Area/Specific Area' = "OldArea") And Title = Area.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "SpecificAreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Specific Area" And Title = 'Specific Area'.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "OtherClinicValue",
                                    Location.Value,
                                    "OperationsManagerName",
                                    'Operations Manager'.DisplayName,
                                    "OwnerName",
                                    Owner.DisplayName,
                                    "MyDepartmentValue",
                                    MyDepartment.Value,
                                    "Description",
                                    PlainText(Description),
                                    "IncidentDate",
                                    IncidentDate,
                                    "Severe",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Boolean" And Lower(Title) = Text(Serious)
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "ModifiedBy",
                                    'Modified By'.DisplayName,
                                    "FinishedDate",
                                    FinishedDate,
                                    "ActionsTaken",
                                    PlainText('Actions Taken'),
                                    "Supplier",
                                    Supplier.Value,
                                    "SupportFunctionValue",
                                    SupportFunction.Value,
                                    "AuthorName",
                                    'Created By'.DisplayName,
                                    "AssigneeStarted",
                                    Last(
                                        FirstN(
                                            Split(
                                                LookUp(
                                                    colAreaList,
                                                    'Area/Specific Area' = "Boolean" And Lower(Title) = Text(AssigneeStarted)
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result
                                )
                            )
                        )
                    LayoutMinHeight: =640
                    LayoutMinWidth: =640
                    SortRotate: =If(Self.ButtonSortValue = locSortColumn && locSortDirection, 180, Self.ButtonSortValue = locSortColumn && locSortDirection = false, 0)
                    Width: =190
                    X: =hdrMyDepartment.X + hdrMyDepartment.Width
                    ZIndex: =9

                hdrArea As TableHeader:
                    ButtonIsSelected: =Self.ButtonSortValue = locSortColumn
                    ButtonOnSelect: |-
                        =UpdateContext({locSortColumn: Self.ButtonSortValue});UpdateContext({locSortDirection: !locSortDirection})
                    ButtonSortValue: ="AreaValue"
                    ButtonText: =LookUp(colTranslations, language.Value = varLanguage And key = "form_label_area").Title
                    FilterIsSelected: =If(Self.ButtonSortValue = locFilterIsSelected.column, locFilterIsSelected.selected, false)
                    FilterOnSelect: |-
                        =UpdateContext(
                            {
                                locFilterIsSelected: {
                                    column: Self.ButtonSortValue,
                                    selected: !locFilterIsSelected.selected
                                }
                            }
                        );
                        ClearCollect(
                            colTableFilter,
                            AddColumns(
                                colTableData,
                                "helper",
                                Switch(
                                    locFilterIsSelected.column,
                                    "Type",
                                    Switch(
                                        First(
                                            Split(
                                                Title,
                                                "_"
                                            )
                                        ).Result,
                                        "IM",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newimprovement" && language.Value = varLanguage
                                            )
                                        ).Title,
                                        "DV",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newdeviation" && language.Value = varLanguage
                                            )
                                        ).Title
                                    ),
                                    "Title",
                                    Title,
                                    "Created",
                                    Created,
                                    "AssigneeName",
                                    Responsible.DisplayName,
                                    "AreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        ('Area/Specific Area' = "Area" Or 'Area/Specific Area' = "OldArea") And Title = Area.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "SpecificAreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Specific Area" And Title = 'Specific Area'.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "OtherClinicValue",
                                    Location.Value,
                                    "OperationsManagerName",
                                    'Operations Manager'.DisplayName,
                                    "OwnerName",
                                    Owner.DisplayName,
                                    "MyDepartmentValue",
                                    MyDepartment.Value,
                                    "Description",
                                    PlainText(Description),
                                    "IncidentDate",
                                    IncidentDate,
                                    "Severe",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Boolean" And Lower(Title) = Text(Serious)
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "ModifiedBy",
                                    'Modified By'.DisplayName,
                                    "FinishedDate",
                                    FinishedDate,
                                    "ActionsTaken",
                                    PlainText('Actions Taken'),
                                    "Supplier",
                                    Supplier.Value,
                                    "SupportFunctionValue",
                                    SupportFunction.Value,
                                    "AuthorName",
                                    'Created By'.DisplayName,
                                    "AssigneeStarted",
                                    Last(
                                        FirstN(
                                            Split(
                                                LookUp(
                                                    colAreaList,
                                                    'Area/Specific Area' = "Boolean" And Lower(Title) = Text(AssigneeStarted)
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result
                                )
                            )
                        )
                    LayoutMinHeight: =640
                    LayoutMinWidth: =640
                    SortRotate: =If(Self.ButtonSortValue = locSortColumn && locSortDirection, 180, Self.ButtonSortValue = locSortColumn && locSortDirection = false, 0)
                    Width: =190
                    X: =490
                    ZIndex: =10

                hdrAssignee As TableHeader:
                    ButtonIsSelected: =Self.ButtonSortValue = locSortColumn
                    ButtonOnSelect: |-
                        =UpdateContext({locSortColumn: Self.ButtonSortValue});UpdateContext({locSortDirection: !locSortDirection})
                    ButtonSortValue: ="AssigneeName"
                    ButtonText: =LookUp(colTranslations, language.Value = varLanguage And key = "form_label_assignee").Title
                    FilterIsSelected: =If(Self.ButtonSortValue = locFilterIsSelected.column, locFilterIsSelected.selected, false)
                    FilterOnSelect: |-
                        =UpdateContext(
                            {
                                locFilterIsSelected: {
                                    column: Self.ButtonSortValue,
                                    selected: !locFilterIsSelected.selected
                                }
                            }
                        );
                        ClearCollect(
                            colTableFilter,
                            AddColumns(
                                colTableData,
                                "helper",
                                Switch(
                                    locFilterIsSelected.column,
                                    "Type",
                                    Switch(
                                        First(
                                            Split(
                                                Title,
                                                "_"
                                            )
                                        ).Result,
                                        "IM",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newimprovement" && language.Value = varLanguage
                                            )
                                        ).Title,
                                        "DV",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newdeviation" && language.Value = varLanguage
                                            )
                                        ).Title
                                    ),
                                    "Title",
                                    Title,
                                    "Created",
                                    Created,
                                    "AssigneeName",
                                    Responsible.DisplayName,
                                    "AreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        ('Area/Specific Area' = "Area" Or 'Area/Specific Area' = "OldArea") And Title = Area.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "SpecificAreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Specific Area" And Title = 'Specific Area'.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "OtherClinicValue",
                                    Location.Value,
                                    "OperationsManagerName",
                                    'Operations Manager'.DisplayName,
                                    "OwnerName",
                                    Owner.DisplayName,
                                    "MyDepartmentValue",
                                    MyDepartment.Value,
                                    "Description",
                                    PlainText(Description),
                                    "IncidentDate",
                                    IncidentDate,
                                    "Severe",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Boolean" And Lower(Title) = Text(Serious)
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "ModifiedBy",
                                    'Modified By'.DisplayName,
                                    "FinishedDate",
                                    FinishedDate,
                                    "ActionsTaken",
                                    PlainText('Actions Taken'),
                                    "Supplier",
                                    Supplier.Value,
                                    "SupportFunctionValue",
                                    SupportFunction.Value,
                                    "AuthorName",
                                    'Created By'.DisplayName,
                                    "AssigneeStarted",
                                    Last(
                                        FirstN(
                                            Split(
                                                LookUp(
                                                    colAreaList,
                                                    'Area/Specific Area' = "Boolean" And Lower(Title) = Text(AssigneeStarted)
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result
                                )
                            )
                        )
                    LayoutMinHeight: =640
                    LayoutMinWidth: =640
                    SortRotate: =If(Self.ButtonSortValue = locSortColumn && locSortDirection, 180, Self.ButtonSortValue = locSortColumn && locSortDirection = false, 0)
                    Width: =190
                    X: =340
                    ZIndex: =11

                hdrSpecArea As TableHeader:
                    ButtonIsSelected: =Self.ButtonSortValue = locSortColumn
                    ButtonOnSelect: |-
                        =UpdateContext({locSortColumn: Self.ButtonSortValue});UpdateContext({locSortDirection: !locSortDirection})
                    ButtonSortValue: ="SpecificAreaValue"
                    ButtonText: =LookUp(colTranslations, language.Value = varLanguage And key = "form_label_specificarea").Title
                    FilterIsSelected: =If(Self.ButtonSortValue = locFilterIsSelected.column, locFilterIsSelected.selected, false)
                    FilterOnSelect: |-
                        =UpdateContext(
                            {
                                locFilterIsSelected: {
                                    column: Self.ButtonSortValue,
                                    selected: !locFilterIsSelected.selected
                                }
                            }
                        );
                        ClearCollect(
                            colTableFilter,
                            AddColumns(
                                colTableData,
                                "helper",
                                Switch(
                                    locFilterIsSelected.column,
                                    "Type",
                                    Switch(
                                        First(
                                            Split(
                                                Title,
                                                "_"
                                            )
                                        ).Result,
                                        "IM",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newimprovement" && language.Value = varLanguage
                                            )
                                        ).Title,
                                        "DV",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newdeviation" && language.Value = varLanguage
                                            )
                                        ).Title
                                    ),
                                    "Title",
                                    Title,
                                    "Created",
                                    Created,
                                    "AssigneeName",
                                    Responsible.DisplayName,
                                    "AreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        ('Area/Specific Area' = "Area" Or 'Area/Specific Area' = "OldArea") And Title = Area.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "SpecificAreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Specific Area" And Title = 'Specific Area'.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "OtherClinicValue",
                                    Location.Value,
                                    "OperationsManagerName",
                                    'Operations Manager'.DisplayName,
                                    "OwnerName",
                                    Owner.DisplayName,
                                    "MyDepartmentValue",
                                    MyDepartment.Value,
                                    "Description",
                                    PlainText(Description),
                                    "IncidentDate",
                                    IncidentDate,
                                    "Severe",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Boolean" And Lower(Title) = Text(Serious)
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "ModifiedBy",
                                    'Modified By'.DisplayName,
                                    "FinishedDate",
                                    FinishedDate,
                                    "ActionsTaken",
                                    PlainText('Actions Taken'),
                                    "Supplier",
                                    Supplier.Value,
                                    "SupportFunctionValue",
                                    SupportFunction.Value,
                                    "AuthorName",
                                    'Created By'.DisplayName,
                                    "AssigneeStarted",
                                    Last(
                                        FirstN(
                                            Split(
                                                LookUp(
                                                    colAreaList,
                                                    'Area/Specific Area' = "Boolean" And Lower(Title) = Text(AssigneeStarted)
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result
                                )
                            )
                        )
                    LayoutMinHeight: =640
                    LayoutMinWidth: =640
                    SortRotate: =If(Self.ButtonSortValue = locSortColumn && locSortDirection, 180, Self.ButtonSortValue = locSortColumn && locSortDirection = false, 0)
                    Width: =190
                    X: =640
                    ZIndex: =12

                hdrSerious As TableHeader:
                    ButtonIsSelected: =Self.ButtonSortValue = locSortColumn
                    ButtonOnSelect: |-
                        =UpdateContext({locSortColumn: Self.ButtonSortValue});UpdateContext({locSortDirection: !locSortDirection})
                    ButtonSortValue: ="Severe"
                    ButtonText: =LookUp(colTranslations, language.Value = varLanguage And key = "form_label_serious").Title
                    FilterIsSelected: =If(Self.ButtonSortValue = locFilterIsSelected.column, locFilterIsSelected.selected, false)
                    FilterOnSelect: |-
                        =UpdateContext(
                            {
                                locFilterIsSelected: {
                                    column: Self.ButtonSortValue,
                                    selected: !locFilterIsSelected.selected
                                }
                            }
                        );
                        ClearCollect(
                            colTableFilter,
                            AddColumns(
                                colTableData,
                                "helper",
                                Switch(
                                    locFilterIsSelected.column,
                                    "Type",
                                    Switch(
                                        First(
                                            Split(
                                                Title,
                                                "_"
                                            )
                                        ).Result,
                                        "IM",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newimprovement" && language.Value = varLanguage
                                            )
                                        ).Title,
                                        "DV",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newdeviation" && language.Value = varLanguage
                                            )
                                        ).Title
                                    ),
                                    "Title",
                                    Title,
                                    "Created",
                                    Created,
                                    "AssigneeName",
                                    Responsible.DisplayName,
                                    "AreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        ('Area/Specific Area' = "Area" Or 'Area/Specific Area' = "OldArea") And Title = Area.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "SpecificAreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Specific Area" And Title = 'Specific Area'.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "OtherClinicValue",
                                    Location.Value,
                                    "OperationsManagerName",
                                    'Operations Manager'.DisplayName,
                                    "OwnerName",
                                    Owner.DisplayName,
                                    "MyDepartmentValue",
                                    MyDepartment.Value,
                                    "Description",
                                    PlainText(Description),
                                    "IncidentDate",
                                    IncidentDate,
                                    "Severe",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Boolean" And Lower(Title) = Text(Serious)
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "ModifiedBy",
                                    'Modified By'.DisplayName,
                                    "FinishedDate",
                                    FinishedDate,
                                    "ActionsTaken",
                                    PlainText('Actions Taken'),
                                    "Supplier",
                                    Supplier.Value,
                                    "SupportFunctionValue",
                                    SupportFunction.Value,
                                    "AuthorName",
                                    'Created By'.DisplayName,
                                    "AssigneeStarted",
                                    Last(
                                        FirstN(
                                            Split(
                                                LookUp(
                                                    colAreaList,
                                                    'Area/Specific Area' = "Boolean" And Lower(Title) = Text(AssigneeStarted)
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result
                                )
                            )
                        )
                    LayoutMinHeight: =640
                    LayoutMinWidth: =640
                    SortRotate: =If(Self.ButtonSortValue = locSortColumn && locSortDirection, 180, Self.ButtonSortValue = locSortColumn && locSortDirection = false, 0)
                    Width: =190
                    X: =hdrObsDate.X + hdrObsDate.Width
                    ZIndex: =13

                hdrObsDate As TableHeader:
                    ButtonIsSelected: =Self.ButtonSortValue = locSortColumn
                    ButtonOnSelect: |-
                        =UpdateContext({locSortColumn: Self.ButtonSortValue});UpdateContext({locSortDirection: !locSortDirection})
                    ButtonSortValue: ="IncidentDate"
                    ButtonText: =LookUp(colTranslations, language.Value = varLanguage And key = "form_label_obsdate").Title
                    FilterIsSelected: =If(Self.ButtonSortValue = locFilterIsSelected.column, locFilterIsSelected.selected, false)
                    FilterOnSelect: |-
                        =UpdateContext(
                            {
                                locFilterIsSelected: {
                                    column: Self.ButtonSortValue,
                                    selected: !locFilterIsSelected.selected
                                }
                            }
                        );
                        ClearCollect(
                            colTableFilter,
                            AddColumns(
                                colTableData,
                                "helper",
                                Switch(
                                    locFilterIsSelected.column,
                                    "Type",
                                    Switch(
                                        First(
                                            Split(
                                                Title,
                                                "_"
                                            )
                                        ).Result,
                                        "IM",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newimprovement" && language.Value = varLanguage
                                            )
                                        ).Title,
                                        "DV",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newdeviation" && language.Value = varLanguage
                                            )
                                        ).Title
                                    ),
                                    "Title",
                                    Title,
                                    "Created",
                                    Created,
                                    "AssigneeName",
                                    Responsible.DisplayName,
                                    "AreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        ('Area/Specific Area' = "Area" Or 'Area/Specific Area' = "OldArea") And Title = Area.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "SpecificAreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Specific Area" And Title = 'Specific Area'.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "OtherClinicValue",
                                    Location.Value,
                                    "OperationsManagerName",
                                    'Operations Manager'.DisplayName,
                                    "OwnerName",
                                    Owner.DisplayName,
                                    "MyDepartmentValue",
                                    MyDepartment.Value,
                                    "Description",
                                    PlainText(Description),
                                    "IncidentDate",
                                    IncidentDate,
                                    "Severe",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Boolean" And Lower(Title) = Text(Serious)
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "ModifiedBy",
                                    'Modified By'.DisplayName,
                                    "FinishedDate",
                                    FinishedDate,
                                    "ActionsTaken",
                                    PlainText('Actions Taken'),
                                    "Supplier",
                                    Supplier.Value,
                                    "SupportFunctionValue",
                                    SupportFunction.Value,
                                    "AuthorName",
                                    'Created By'.DisplayName,
                                    "AssigneeStarted",
                                    Last(
                                        FirstN(
                                            Split(
                                                LookUp(
                                                    colAreaList,
                                                    'Area/Specific Area' = "Boolean" And Lower(Title) = Text(AssigneeStarted)
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result
                                )
                            )
                        )
                    LayoutMinHeight: =640
                    LayoutMinWidth: =640
                    SortRotate: =If(Self.ButtonSortValue = locSortColumn && locSortDirection, 180, Self.ButtonSortValue = locSortColumn && locSortDirection = false, 0)
                    Width: =190
                    X: =hdrDescription.X + hdrDescription.Width
                    ZIndex: =14

                hdrMyDepartment As TableHeader:
                    ButtonIsSelected: =Self.ButtonSortValue = locSortColumn
                    ButtonOnSelect: |-
                        =UpdateContext({locSortColumn: Self.ButtonSortValue});UpdateContext({locSortDirection: !locSortDirection})
                    ButtonSortValue: ="MyDepartmentValue"
                    ButtonText: =LookUp(colTranslations, language.Value = varLanguage And key = "form_label_mydepartment").Title
                    FilterIsSelected: =If(Self.ButtonSortValue = locFilterIsSelected.column, locFilterIsSelected.selected, false)
                    FilterOnSelect: |-
                        =UpdateContext(
                            {
                                locFilterIsSelected: {
                                    column: Self.ButtonSortValue,
                                    selected: !locFilterIsSelected.selected
                                }
                            }
                        );
                        ClearCollect(
                            colTableFilter,
                            AddColumns(
                                colTableData,
                                "helper",
                                Switch(
                                    locFilterIsSelected.column,
                                    "Type",
                                    Switch(
                                        First(
                                            Split(
                                                Title,
                                                "_"
                                            )
                                        ).Result,
                                        "IM",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newimprovement" && language.Value = varLanguage
                                            )
                                        ).Title,
                                        "DV",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newdeviation" && language.Value = varLanguage
                                            )
                                        ).Title
                                    ),
                                    "Title",
                                    Title,
                                    "Created",
                                    Created,
                                    "AssigneeName",
                                    Responsible.DisplayName,
                                    "AreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        ('Area/Specific Area' = "Area" Or 'Area/Specific Area' = "OldArea") And Title = Area.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "SpecificAreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Specific Area" And Title = 'Specific Area'.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "OtherClinicValue",
                                    Location.Value,
                                    "OperationsManagerName",
                                    'Operations Manager'.DisplayName,
                                    "OwnerName",
                                    Owner.DisplayName,
                                    "MyDepartmentValue",
                                    MyDepartment.Value,
                                    "Description",
                                    PlainText(Description),
                                    "IncidentDate",
                                    IncidentDate,
                                    "Severe",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Boolean" And Lower(Title) = Text(Serious)
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "ModifiedBy",
                                    'Modified By'.DisplayName,
                                    "FinishedDate",
                                    FinishedDate,
                                    "ActionsTaken",
                                    PlainText('Actions Taken'),
                                    "Supplier",
                                    Supplier.Value,
                                    "SupportFunctionValue",
                                    SupportFunction.Value,
                                    "AuthorName",
                                    'Created By'.DisplayName,
                                    "AssigneeStarted",
                                    Last(
                                        FirstN(
                                            Split(
                                                LookUp(
                                                    colAreaList,
                                                    'Area/Specific Area' = "Boolean" And Lower(Title) = Text(AssigneeStarted)
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result
                                )
                            )
                        )
                    LayoutMinHeight: =640
                    LayoutMinWidth: =640
                    SortRotate: =If(Self.ButtonSortValue = locSortColumn && locSortDirection, 180, Self.ButtonSortValue = locSortColumn && locSortDirection = false, 0)
                    Width: =190
                    X: =1240
                    ZIndex: =15

                hdrOwner As TableHeader:
                    ButtonIsSelected: =Self.ButtonSortValue = locSortColumn
                    ButtonOnSelect: |-
                        =UpdateContext({locSortColumn: Self.ButtonSortValue});UpdateContext({locSortDirection: !locSortDirection})
                    ButtonSortValue: ="OwnerName"
                    ButtonText: ="Owner"//LookUp(colTranslations, language.Value = varLanguage And key = "form_label_owner").Title
                    FilterIsSelected: =If(Self.ButtonSortValue = locFilterIsSelected.column, locFilterIsSelected.selected, false)
                    FilterOnSelect: |-
                        =UpdateContext(
                            {
                                locFilterIsSelected: {
                                    column: Self.ButtonSortValue,
                                    selected: !locFilterIsSelected.selected
                                }
                            }
                        );
                        ClearCollect(
                            colTableFilter,
                            AddColumns(
                                colTableData,
                                "helper",
                                Switch(
                                    locFilterIsSelected.column,
                                    "Type",
                                    Switch(
                                        First(
                                            Split(
                                                Title,
                                                "_"
                                            )
                                        ).Result,
                                        "IM",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newimprovement" && language.Value = varLanguage
                                            )
                                        ).Title,
                                        "DV",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newdeviation" && language.Value = varLanguage
                                            )
                                        ).Title
                                    ),
                                    "Title",
                                    Title,
                                    "Created",
                                    Created,
                                    "AssigneeName",
                                    Responsible.DisplayName,
                                    "AreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        ('Area/Specific Area' = "Area" Or 'Area/Specific Area' = "OldArea") And Title = Area.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "SpecificAreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Specific Area" And Title = 'Specific Area'.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "OtherClinicValue",
                                    Location.Value,
                                    "OperationsManagerName",
                                    'Operations Manager'.DisplayName,
                                    "OwnerName",
                                    Owner.DisplayName,
                                    "MyDepartmentValue",
                                    MyDepartment.Value,
                                    "Description",
                                    PlainText(Description),
                                    "IncidentDate",
                                    IncidentDate,
                                    "Severe",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Boolean" And Lower(Title) = Text(Serious)
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "ModifiedBy",
                                    'Modified By'.DisplayName,
                                    "FinishedDate",
                                    FinishedDate,
                                    "ActionsTaken",
                                    PlainText('Actions Taken'),
                                    "Supplier",
                                    Supplier.Value,
                                    "SupportFunctionValue",
                                    SupportFunction.Value,
                                    "AuthorName",
                                    'Created By'.DisplayName,
                                    "AssigneeStarted",
                                    Last(
                                        FirstN(
                                            Split(
                                                LookUp(
                                                    colAreaList,
                                                    'Area/Specific Area' = "Boolean" And Lower(Title) = Text(AssigneeStarted)
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result
                                )
                            )
                        )
                    LayoutMinHeight: =640
                    LayoutMinWidth: =640
                    SortRotate: =If(Self.ButtonSortValue = locSortColumn && locSortDirection, 180, Self.ButtonSortValue = locSortColumn && locSortDirection = false, 0)
                    Width: =190
                    X: =1090
                    ZIndex: =16

                hdrManager As TableHeader:
                    ButtonIsSelected: =Self.ButtonSortValue = locSortColumn
                    ButtonOnSelect: |-
                        =UpdateContext({locSortColumn: Self.ButtonSortValue});UpdateContext({locSortDirection: !locSortDirection})
                    ButtonSortValue: ="OperationsManagerName"
                    ButtonText: =LookUp(colTranslations, language.Value = varLanguage And key = "form_label_manager").Title
                    FilterIsSelected: =If(Self.ButtonSortValue = locFilterIsSelected.column, locFilterIsSelected.selected, false)
                    FilterOnSelect: |-
                        =UpdateContext(
                            {
                                locFilterIsSelected: {
                                    column: Self.ButtonSortValue,
                                    selected: !locFilterIsSelected.selected
                                }
                            }
                        );
                        ClearCollect(
                            colTableFilter,
                            AddColumns(
                                colTableData,
                                "helper",
                                Switch(
                                    locFilterIsSelected.column,
                                    "Type",
                                    Switch(
                                        First(
                                            Split(
                                                Title,
                                                "_"
                                            )
                                        ).Result,
                                        "IM",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newimprovement" && language.Value = varLanguage
                                            )
                                        ).Title,
                                        "DV",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newdeviation" && language.Value = varLanguage
                                            )
                                        ).Title
                                    ),
                                    "Title",
                                    Title,
                                    "Created",
                                    Created,
                                    "AssigneeName",
                                    Responsible.DisplayName,
                                    "AreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        ('Area/Specific Area' = "Area" Or 'Area/Specific Area' = "OldArea") And Title = Area.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "SpecificAreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Specific Area" And Title = 'Specific Area'.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "OtherClinicValue",
                                    Location.Value,
                                    "OperationsManagerName",
                                    'Operations Manager'.DisplayName,
                                    "OwnerName",
                                    Owner.DisplayName,
                                    "MyDepartmentValue",
                                    MyDepartment.Value,
                                    "Description",
                                    PlainText(Description),
                                    "IncidentDate",
                                    IncidentDate,
                                    "Severe",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Boolean" And Lower(Title) = Text(Serious)
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "ModifiedBy",
                                    'Modified By'.DisplayName,
                                    "FinishedDate",
                                    FinishedDate,
                                    "ActionsTaken",
                                    PlainText('Actions Taken'),
                                    "Supplier",
                                    Supplier.Value,
                                    "SupportFunctionValue",
                                    SupportFunction.Value,
                                    "AuthorName",
                                    'Created By'.DisplayName,
                                    "AssigneeStarted",
                                    Last(
                                        FirstN(
                                            Split(
                                                LookUp(
                                                    colAreaList,
                                                    'Area/Specific Area' = "Boolean" And Lower(Title) = Text(AssigneeStarted)
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result
                                )
                            )
                        )
                    LayoutMinHeight: =640
                    LayoutMinWidth: =640
                    SortRotate: =If(Self.ButtonSortValue = locSortColumn && locSortDirection, 180, Self.ButtonSortValue = locSortColumn && locSortDirection = false, 0)
                    Width: =190
                    X: =940
                    ZIndex: =17

                hdrOtherClinic As TableHeader:
                    ButtonIsSelected: =Self.ButtonSortValue = locSortColumn
                    ButtonOnSelect: |-
                        =UpdateContext({locSortColumn: Self.ButtonSortValue});UpdateContext({locSortDirection: !locSortDirection})
                    ButtonSortValue: ="OtherClinicValue"
                    ButtonText: =LookUp(colTranslations, language.Value = varLanguage And key = "form_option_recdep_otherclinic").Title
                    FilterIsSelected: =If(Self.ButtonSortValue = locFilterIsSelected.column, locFilterIsSelected.selected, false)
                    FilterOnSelect: |-
                        =UpdateContext(
                            {
                                locFilterIsSelected: {
                                    column: Self.ButtonSortValue,
                                    selected: !locFilterIsSelected.selected
                                }
                            }
                        );
                        ClearCollect(
                            colTableFilter,
                            AddColumns(
                                colTableData,
                                "helper",
                                Switch(
                                    locFilterIsSelected.column,
                                    "Type",
                                    Switch(
                                        First(
                                            Split(
                                                Title,
                                                "_"
                                            )
                                        ).Result,
                                        "IM",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newimprovement" && language.Value = varLanguage
                                            )
                                        ).Title,
                                        "DV",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newdeviation" && language.Value = varLanguage
                                            )
                                        ).Title
                                    ),
                                    "Title",
                                    Title,
                                    "Created",
                                    Created,
                                    "AssigneeName",
                                    Responsible.DisplayName,
                                    "AreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        ('Area/Specific Area' = "Area" Or 'Area/Specific Area' = "OldArea") And Title = Area.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "SpecificAreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Specific Area" And Title = 'Specific Area'.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "OtherClinicValue",
                                    Location.Value,
                                    "OperationsManagerName",
                                    'Operations Manager'.DisplayName,
                                    "OwnerName",
                                    Owner.DisplayName,
                                    "MyDepartmentValue",
                                    MyDepartment.Value,
                                    "Description",
                                    PlainText(Description),
                                    "IncidentDate",
                                    IncidentDate,
                                    "Severe",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Boolean" And Lower(Title) = Text(Serious)
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "ModifiedBy",
                                    'Modified By'.DisplayName,
                                    "FinishedDate",
                                    FinishedDate,
                                    "ActionsTaken",
                                    PlainText('Actions Taken'),
                                    "Supplier",
                                    Supplier.Value,
                                    "SupportFunctionValue",
                                    SupportFunction.Value,
                                    "AuthorName",
                                    'Created By'.DisplayName,
                                    "AssigneeStarted",
                                    Last(
                                        FirstN(
                                            Split(
                                                LookUp(
                                                    colAreaList,
                                                    'Area/Specific Area' = "Boolean" And Lower(Title) = Text(AssigneeStarted)
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result
                                )
                            )
                        )
                    LayoutMinHeight: =640
                    LayoutMinWidth: =640
                    SortRotate: =If(Self.ButtonSortValue = locSortColumn && locSortDirection, 180, Self.ButtonSortValue = locSortColumn && locSortDirection = false, 0)
                    Width: =190
                    X: =790
                    ZIndex: =18

                hdrSupplier As TableHeader:
                    ButtonIsSelected: =Self.ButtonSortValue = locSortColumn
                    ButtonOnSelect: |-
                        =UpdateContext({locSortColumn: Self.ButtonSortValue});UpdateContext({locSortDirection: !locSortDirection})
                    ButtonSortValue: ="SupplierValue"
                    ButtonText: =LookUp(colTranslations, language.Value = varLanguage And key = "form_option_recdep_supplier").Title
                    FilterIsSelected: =If(Self.ButtonSortValue = locFilterIsSelected.column, locFilterIsSelected.selected, false)
                    FilterOnSelect: |-
                        =UpdateContext(
                            {
                                locFilterIsSelected: {
                                    column: Self.ButtonSortValue,
                                    selected: !locFilterIsSelected.selected
                                }
                            }
                        );
                        ClearCollect(
                            colTableFilter,
                            AddColumns(
                                colTableData,
                                "helper",
                                Switch(
                                    locFilterIsSelected.column,
                                    "Type",
                                    Switch(
                                        First(
                                            Split(
                                                Title,
                                                "_"
                                            )
                                        ).Result,
                                        "IM",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newimprovement" && language.Value = varLanguage
                                            )
                                        ).Title,
                                        "DV",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newdeviation" && language.Value = varLanguage
                                            )
                                        ).Title
                                    ),
                                    "Title",
                                    Title,
                                    "Created",
                                    Created,
                                    "AssigneeName",
                                    Responsible.DisplayName,
                                    "AreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        ('Area/Specific Area' = "Area" Or 'Area/Specific Area' = "OldArea") And Title = Area.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "SpecificAreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Specific Area" And Title = 'Specific Area'.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "OtherClinicValue",
                                    Location.Value,
                                    "OperationsManagerName",
                                    'Operations Manager'.DisplayName,
                                    "OwnerName",
                                    Owner.DisplayName,
                                    "MyDepartmentValue",
                                    MyDepartment.Value,
                                    "Description",
                                    PlainText(Description),
                                    "IncidentDate",
                                    IncidentDate,
                                    "Severe",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Boolean" And Lower(Title) = Text(Serious)
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "ModifiedBy",
                                    'Modified By'.DisplayName,
                                    "FinishedDate",
                                    FinishedDate,
                                    "ActionsTaken",
                                    PlainText('Actions Taken'),
                                    "Supplier",
                                    Supplier.Value,
                                    "SupportFunctionValue",
                                    SupportFunction.Value,
                                    "AuthorName",
                                    'Created By'.DisplayName,
                                    "AssigneeStarted",
                                    Last(
                                        FirstN(
                                            Split(
                                                LookUp(
                                                    colAreaList,
                                                    'Area/Specific Area' = "Boolean" And Lower(Title) = Text(AssigneeStarted)
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result
                                )
                            )
                        )
                    LayoutMinHeight: =640
                    LayoutMinWidth: =640
                    SortRotate: =If(Self.ButtonSortValue = locSortColumn && locSortDirection, 180, Self.ButtonSortValue = locSortColumn && locSortDirection = false, 0)
                    Width: =190
                    X: =hdrActionsTaken.X + hdrActionsTaken.Width
                    ZIndex: =19

                hdrSupportFunction As TableHeader:
                    ButtonIsSelected: =Self.ButtonSortValue = locSortColumn
                    ButtonOnSelect: |-
                        =UpdateContext({locSortColumn: Self.ButtonSortValue});UpdateContext({locSortDirection: !locSortDirection})
                    ButtonSortValue: ="SupportFunctionValue"
                    ButtonText: =LookUp(colTranslations, language.Value = varLanguage And key = "form_option_recdep_supportfunction").Title
                    FilterIsSelected: =If(Self.ButtonSortValue = locFilterIsSelected.column, locFilterIsSelected.selected, false)
                    FilterOnSelect: |-
                        =UpdateContext(
                            {
                                locFilterIsSelected: {
                                    column: Self.ButtonSortValue,
                                    selected: !locFilterIsSelected.selected
                                }
                            }
                        );
                        ClearCollect(
                            colTableFilter,
                            AddColumns(
                                colTableData,
                                "helper",
                                Switch(
                                    locFilterIsSelected.column,
                                    "Type",
                                    Switch(
                                        First(
                                            Split(
                                                Title,
                                                "_"
                                            )
                                        ).Result,
                                        "IM",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newimprovement" && language.Value = varLanguage
                                            )
                                        ).Title,
                                        "DV",
                                        First(
                                            Filter(
                                                DeviationSystemTranslations,
                                                key = "button_newdeviation" && language.Value = varLanguage
                                            )
                                        ).Title
                                    ),
                                    "Title",
                                    Title,
                                    "Created",
                                    Created,
                                    "AssigneeName",
                                    Responsible.DisplayName,
                                    "AreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        ('Area/Specific Area' = "Area" Or 'Area/Specific Area' = "OldArea") And Title = Area.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "SpecificAreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Specific Area" And Title = 'Specific Area'.Value
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "OtherClinicValue",
                                    Location.Value,
                                    "OperationsManagerName",
                                    'Operations Manager'.DisplayName,
                                    "OwnerName",
                                    Owner.DisplayName,
                                    "MyDepartmentValue",
                                    MyDepartment.Value,
                                    "Description",
                                    PlainText(Description),
                                    "IncidentDate",
                                    IncidentDate,
                                    "Severe",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Boolean" And Lower(Title) = Text(Serious)
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "ModifiedBy",
                                    'Modified By'.DisplayName,
                                    "FinishedDate",
                                    FinishedDate,
                                    "ActionsTaken",
                                    PlainText('Actions Taken'),
                                    "Supplier",
                                    Supplier.Value,
                                    "SupportFunctionValue",
                                    SupportFunction.Value,
                                    "AuthorName",
                                    'Created By'.DisplayName,
                                    "AssigneeStarted",
                                    Last(
                                        FirstN(
                                            Split(
                                                LookUp(
                                                    colAreaList,
                                                    'Area/Specific Area' = "Boolean" And Lower(Title) = Text(AssigneeStarted)
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result
                                )
                            )
                        )
                    LayoutMinHeight: =640
                    LayoutMinWidth: =640
                    SortRotate: =If(Self.ButtonSortValue = locSortColumn && locSortDirection, 180, Self.ButtonSortValue = locSortColumn && locSortDirection = false, 0)
                    Width: =190
                    X: =hdrActionsTaken.X + hdrActionsTaken.Width
                    ZIndex: =20

    Label2_13 As label:
        Align: =Align.Center
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Size: =15.65
        Text: =LookUp(colTranslations, language.Value = varLanguage And key = "label_reportedmydepartment").Title & " (" & If(varClosedView = 0, LookUp(colTranslations, language.Value = varLanguage And key = "button_inprogress").Title, LookUp(colTranslations, language.Value = varLanguage And key = "button_closed").Title) & ")"
        Width: =400
        X: =Parent.Width / 2 - Self.Width / 2
        Y: =Icon1_11.Y + Icon1_11.Height / 2 - Self.Height / 2
        ZIndex: =4

    dropdownFilters As combobox:
        BorderColor: =RGBA(166, 166, 166, 1)
        BorderThickness: =1
        ChevronBackground: =RGBA(255, 255, 255, 1)
        ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
        ChevronDisabledFill: =RGBA(166, 166, 166, 1)
        ChevronFill: =RGBA(33, 33, 33, 1)
        ChevronHoverBackground: =RGBA(212, 212, 212, 1)
        ChevronHoverFill: =RGBA(33, 33, 33, 1)
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        DisplayFields: =["Result"]
        FocusedBorderThickness: =0
        Font: =Font.'Segoe UI'
        HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
        HoverColor: =RGBA(51, 51, 51, 1)
        HoverFill: =RGBA(212, 212, 212, 1)
        InputTextPlaceholder: =LookUp(colTranslations, language.Value = varLanguage And key = "placeholder_dropdownFilters").Title
        IsSearchable: =false
        Items: |-
            =Sort(
                Split(
                    Concat(
                        Distinct(
                            Filter(
                                Filter(
                                    colTableFilter,
                                    Switch(
                                        varClosedView,
                                        0,
                                        Finished = false,
                                        1,
                                        Finished = true
                                    )
                                ),
                                If(
                                    locFilterAssignee = "" And !IsBlank(locFilterMyDepartment) And locFilterManager = "" And locFilterCompany = "",
                                    MyDepartment.Id exactin 
                                        varParentDepartment.ID,
                                    Responsible.DisplayName = locFilterAssignee Or 'Operations Manager'.DisplayName = locFilterManager Or Owner.DisplayName = locFilterManager Or MyDepartment.Id in locFilterMyDepartment Or locFilterCompany in Filter(
                                        colData,
                                        MyDepartment.Id = ID
                                    ).Company
                                )
                            ),
                            helper
                        ),
                        Result,
                        ";"
                    ),
                    ";"
                ),
                Result,
                Ascending
            )
        NoSelectionText: =LookUp(colTranslations, language.Value = varLanguage And key = "placeholder_dropdownFilters").Title
        OnChange: =Select(collectMyDepartment)
        PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =RGBA(105, 121, 126, 1)
        Reset: =locFilterIsSelected.selected = false
        SearchFields: =["Result"]
        SearchItems: =[]
        SelectionFill: =RGBA(105, 121, 126, 1)
        Size: =10
        Visible: =locFilterIsSelected.selected
        Width: =If(App.Width > App.Height, Parent.Width * .3, Container4.Width - clearFilters.Width)
        X: =Container4.X + Container4.Width - Self.Width
        Y: =If(App.Width > App.Height, checkboxesContainer.Y, checkboxesContainer.Y + checkboxesContainer.Height)
        ZIndex: =5

    clearFilters As icon.Cancel:
        BorderColor: =RGBA(166, 166, 166, 1)
        Color: =RGBA(105, 121, 126, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(220, 220, 220, 1)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Height: =40
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
        HoverFill: =RGBA(0, 0, 0, 0)
        Icon: =Icon.Cancel
        OnSelect: |-
            =UpdateContext({locFilterIsSelected: { selected: false }})
        PaddingBottom: =10
        PaddingLeft: =10
        PaddingRight: =10
        PaddingTop: =10
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
        PressedFill: =RGBA(0, 0, 0, 0)
        Visible: =locFilterIsSelected.selected
        Width: =40
        X: =dropdownFilters.X - Self.Width
        Y: =dropdownFilters.Y
        ZIndex: =6

    Label2_14 As label:
        Align: =Align.Center
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Height: =20
        Size: =9.25
        Text: |-
            =If(
                IsBlank(
                    First(
                        Filter(
                            colData,
                            First(colUser).Department = Location
                        )
                    ).'Parent'
                ),
                First(colUser).Department,
                If(
                    //IsBlank(First('Office365-användare'.DirectReportsV2(varUserPrincipalName).value).department),
                    IsBlank(varUserDirectReport.department),
                    First(
                        Filter(
                            colData,
                            First(colUser).Department = Location And First(colUser).City
                        )
                    ).'Parent',
                    First(
                        Filter(
                            colData,
                            //First('Office365-användare'.DirectReportsV2(varUserPrincipalName).value).department = Location
                            varUserDirectReport.department = Location And varUserDirectReport.city = City
                        )
                    ).'Parent'
                )
            )
        Width: =267.51
        X: =Parent.Width / 2 - Self.Width / 2
        Y: =Label2_13.Y + Label2_13.Height
        ZIndex: =7

    Label11 As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        Height: =20
        Size: =9
        Text: =LookUp(colTranslations, language.Value = varLanguage And key = "table_option_level").Title
        Width: =346
        X: =Container4.X
        Y: =Label2_14.Y + Label2_14.Height + 10
        ZIndex: =8

    checkboxesContainer As groupContainer.horizontalAutoLayoutContainer:
        Height: =40
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowX: =LayoutOverflow.Scroll
        LayoutWrap: =true
        Width: =If(App.Width > App.Height, Parent.Width / 2, Container4.Width)
        X: =Container4.X
        Y: =Label11.Y + Label11.Height
        ZIndex: =9

        Checkbox1_2 As checkbox:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            CheckboxBorderColor: =RGBA(102, 102, 102, 1)
            CheckboxSize: =30
            CheckmarkFill: =RGBA(105, 121, 126, 1)
            Color: =RGBA(51, 51, 51, 1)
            Default: =true
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =0
            Font: =Font.'Segoe UI'
            Height: =40
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(0, 0, 0, 0)
            LayoutMinHeight: =40
            LayoutMinWidth: =130
            OnCheck: |-
                =//UpdateContext({locFilterMyDepartment: varParentDepartment.ID})
                UpdateContext({locFilterMyDepartment: ForAll(varParentDepartment, ID)})
            OnSelect: |-
                =UpdateContext({varPreLoader: true});Select(collectMyDepartment)
            OnUncheck: |-
                =UpdateContext({locFilterMyDepartment: []})
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =RGBA(51, 51, 51, 1)
            PressedFill: =RGBA(0, 0, 0, 0)
            Size: =9.25
            Text: =LookUp(colTranslations, language.Value = varLanguage And key = "label_reportedmydepartment").Title
            Width: =160
            X: =Checkbox1.X + Checkbox1.Width
            Y: =Checkbox1.Y
            ZIndex: =1

        Checkbox1 As checkbox:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            CheckboxBorderColor: =RGBA(102, 102, 102, 1)
            CheckboxSize: =30
            CheckmarkFill: =RGBA(105, 121, 126, 1)
            Color: =RGBA(51, 51, 51, 1)
            Default: =varIsResponsible
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =0
            Font: =Font.'Segoe UI'
            Height: =40
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(0, 0, 0, 0)
            LayoutMinHeight: =40
            LayoutMinWidth: =130
            OnCheck: |-
                =UpdateContext({locFilterAssignee: First(colUser).DisplayName})
            OnSelect: |-
                =UpdateContext({varPreLoader: true});Select(collectMyDepartment)
            OnUncheck: |-
                =UpdateContext({locFilterAssignee: ""})
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =RGBA(51, 51, 51, 1)
            PressedFill: =RGBA(0, 0, 0, 0)
            Size: =9.25
            Text: =LookUp(colTranslations, language.Value = varLanguage And key = "form_label_assignee").Title
            X: =Container4.X
            Y: =79.99999999999999
            ZIndex: =2

        Checkbox1_1 As checkbox:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            CheckboxBorderColor: =RGBA(102, 102, 102, 1)
            CheckboxSize: =30
            CheckmarkFill: =RGBA(105, 121, 126, 1)
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =0
            Font: =Font.'Segoe UI'
            Height: =40
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(0, 0, 0, 0)
            LayoutMinHeight: =40
            LayoutMinWidth: =110
            OnCheck: |-
                =UpdateContext({locFilterManager: First(colUser).DisplayName})
            OnSelect: |-
                =UpdateContext({varPreLoader: true});Select(collectMyDepartment)
            OnUncheck: |-
                =UpdateContext({locFilterManager: ""})
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =RGBA(51, 51, 51, 1)
            PressedFill: =RGBA(0, 0, 0, 0)
            Size: =9.25
            Text: =LookUp(colTranslations, language.Value = varLanguage And key = "form_label_manager").Title
            Visible: =false
            Width: =120
            X: =Checkbox1_2.X + Checkbox1_2.Width
            Y: =Checkbox1.Y
            ZIndex: =3

        Checkbox1_3 As checkbox:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            CheckboxBorderColor: =RGBA(102, 102, 102, 1)
            CheckboxSize: =30
            CheckmarkFill: =RGBA(105, 121, 126, 1)
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =0
            Font: =Font.'Segoe UI'
            Height: =40
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(0, 0, 0, 0)
            LayoutMinHeight: =40
            LayoutMinWidth: =130
            OnCheck: |-
                =UpdateContext({locFilterCompany: First(Filter(colData, Location = First(colUser).Department)).Company})
            OnSelect: |-
                =UpdateContext({varPreLoader: true});Select(collectMyDepartment)
            OnUncheck: |-
                =UpdateContext({locFilterCompany: ""})
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =RGBA(51, 51, 51, 1)
            PressedFill: =RGBA(0, 0, 0, 0)
            Size: =9.25
            Text: |-
                =LookUp(colTranslations, language.Value = varLanguage And key = "label_all_departments").Title & " (" & First(
                    Filter(
                        colData,
                        First(colUser).Department = Location
                    )
                ).Company & ")"
            Width: =200
            X: =Checkbox1_1.X + Checkbox1_1.Width
            Y: =Checkbox1.Y
            ZIndex: =4

    PreLoader_6 As groupContainer:
        Fill: =RGBA(255, 255, 255, 0.7)
        Height: =Parent.Height
        Visible: =varPreLoader
        Width: =Parent.Width
        X: =Parent.Width / 2 - Self.Width / 2
        Y: =Parent.Height / 2 - Self.Height / 2
        ZIndex: =10

        loadingSpinner As image:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =4
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverFill: =RGBA(0, 0, 0, 0)
            Image: ='icons8-loading-circle'
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedFill: =RGBA(0, 0, 0, 0)
            X: =Parent.Width / 2 - Self.Width / 2
            Y: =Parent.Height / 2 - Self.Height / 2
            ZIndex: =3

    Icon1_11 As icon.Cancel:
        BorderColor: =RGBA(166, 166, 166, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(220, 220, 220, 1)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Height: =Parent.Height * 0.06
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
        HoverFill: =RGBA(0, 0, 0, 0)
        Icon: =Icon.Cancel
        OnSelect: =ResetForm(Form1);Navigate(Start)
        PaddingBottom: =5
        PaddingLeft: =5
        PaddingRight: =5
        PaddingTop: =5
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
        PressedFill: =RGBA(0, 0, 0, 0)
        Width: =Self.Height
        X: =Self.Y
        Y: =Self.Height / 2
        ZIndex: =11

    collectMyDepartment As button:
        BorderColor: =RGBA(0, 0, 0, 0)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: =RGBA(105, 121, 126, 1)
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
        OnSelect: |-
            =ClearCollect(
                colMyDepartment,
                AddColumns(
                    //Filter for assignee checkboxer
                    Filter(
                        //Switch for column header filters
                        If(
                            locFilterIsSelected.selected And (!IsBlank(dropdownFilters.SelectedItems) And !IsEmpty(dropdownFilters.SelectedItems)),
                            Filter(
                                Filter(
                                    colTableData,
                                    Switch(
                                        varClosedView,
                                        0,
                                        Finished = false,
                                        1,
                                        Finished = true
                                    )
                                ),
                                Switch(
                                    locFilterIsSelected.column,
                                    "Type",
                                    Switch(
                                        First(
                                            Split(
                                                Title,
                                                "_"
                                            )
                                        ).Result,
                                        "IM",
                                        LookUp(
                                            colTranslations,
                                            key = "button_newimprovement" && language.Value = varLanguage
                                        ).Title,
                                        "DV",
                                        LookUp(
                                            colTranslations,
                                            key = "button_newdeviation" && language.Value = varLanguage
                                        ).Title
                                    ),
                                    "Title",
                                    Title,
                                    "Created",
                                    Created,
                                    "AssigneeName",
                                    Responsible.DisplayName,
                                    "AreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                LookUp(
                                                    colAreaList,
                                                    ('Area/Specific Area' = "Area" Or 'Area/Specific Area' = "OldArea") And Title = Area.Value
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "SpecificAreaValue",
                                    Last(
                                        FirstN(
                                            Split(
                                                LookUp(
                                                    colAreaList,
                                                    'Area/Specific Area' = "Specific Area" And Title = 'Specific Area'.Value
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "OtherClinicValue",
                                    Location.Value,
                                    "OperationsManagerName",
                                    'Operations Manager'.DisplayName,
                                    "OwnerName",
                                    Owner.DisplayName,
                                    "MyDepartmentValue",
                                    MyDepartment.Value,
                                    "Description",
                                    PlainText(Description),
                                    "Observation Date",
                                    IncidentDate,
                                    "Severe",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Boolean" And Lower(Title) = Text(Serious)
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result,
                                    "ModifiedBy",
                                    'Modified By'.DisplayName,
                                    "FinishedDate",
                                    FinishedDate,
                                    "ActionsTaken",
                                    PlainText('Actions Taken'),
                                    "Supplier",
                                    Supplier.Value,
                                    "SupportFunctionValue",
                                    SupportFunction.Value,
                                    "AuthorName",
                                    'Created By'.DisplayName,
                                    "AssigneeStarted",
                                    Last(
                                        FirstN(
                                            Split(
                                                First(
                                                    Filter(
                                                        colAreaList,
                                                        'Area/Specific Area' = "Boolean" And Lower(Title) = Text(AssigneeStarted)
                                                    )
                                                ).Translation,
                                                ";"
                                            ),
                                            varLanguageID
                                        )
                                    ).Result
                                ) in dropdownFilters.SelectedItems.Result
                            ),
                            Filter(
                                colTableData,
                                Switch(
                                    varClosedView,
                                    0,
                                    Finished = false,
                                    1,
                                    Finished = true
                                )
                            )
                        ),
                        If(
                            locFilterAssignee = "" And !IsBlank(locFilterMyDepartment) And locFilterManager = "" And locFilterCompany = "",
                            MyDepartment.Id exactin varParentDepartment.ID,
                            (
                                Responsible.DisplayName = locFilterAssignee Or
                                'Operations Manager'.DisplayName = locFilterManager Or
                                'Default Responsible'.DisplayName = locFilterManager Or
                                Owner.DisplayName = locFilterManager Or
                                MyDepartment.Id in locFilterMyDepartment Or
                                    locFilterCompany in Filter(
                                    colData,
                                    MyDepartment.Id = ID
                                ).Company Or
                                SupportFunction.Id exactin locFilterMyDepartment Or
                                Location.Id exactin locFilterMyDepartment
                            )
                        )
                    ),
                    "AuthorName",
                    'Created By'.DisplayName,
                    "OwnerName",
                    Owner.DisplayName,
                    "AssigneeName",
                    Responsible.DisplayName,
                    "AreaValue",
                    Last(
                        FirstN(
                            Split(
                                LookUp(
                                    colAreaList,
                                    ('Area/Specific Area' = "Area" Or 'Area/Specific Area' = "OldArea") And Title = Area.Value
                                ).Translation,
                                ";"
                            ),
                            varLanguageID
                        )
                    ).Result,
                    "SpecificAreaValue",
                    Last(
                        FirstN(
                            Split(
                                LookUp(
                                    colAreaList,
                                    'Area/Specific Area' = "Specific Area" And Title = 'Specific Area'.Value
                                ).Translation,
                                ";"
                            ),
                            varLanguageID
                        )
                    ).Result,
                    "ExternalChoicesValue",
                    ExternalChoices.Value,
                    "OtherClinicValue",
                    Location.Value,
                    "SupportFunctionValue",
                    SupportFunction.Value,
                    "SupplierValue",
                    Supplier.Value,
                    "ModifiedBy",
                    'Modified By'.DisplayName,
                    "MyDepartmentValue",
                    MyDepartment.Value,
                    "OperationsManagerName",
                    'Operations Manager'.DisplayName
                )
            );
            UpdateContext({varPreLoader: false})
        PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =15
        Text: ="collectMyDepartment"
        Visible: =false
        Width: =272
        X: =210
        Y: =26
        ZIndex: =12

